(function($){'use strict'; $(document).ready(function(){var fileArray = []; $('input[type=file]').on('change', prepareUpload); function prepareUpload()
{var file = this.files[0]; fileArray.push(file)}
jQuery(document).on('submit', '.power_form_handle', function(e){e.preventDefault(); var fd = new FormData(); var formId = $(this).attr('data-formid'); var formdata = $(this).serializeArray(); $.each(formdata, function(key, input){fd.append(input.name, input.value)}); if (fileArray){fileArray.forEach(function(item, index){fd.append('pf_File_' + index, item)})}
fd.append('action', 'pf_save_frontend_form'); fd.append('formId', formId); var recaptcha = $("#power_forms_" + formId + " #g-recaptcha-response").val(); if (recaptcha === ""){e.preventDefault(); $('#power_forms_' + formId + ' #captcha-error').addClass('wppowerformerror'); $('#power_forms_' + formId + ' #captcha-error').text('Please fill the recaptcha'); $('#power_forms_' + formId + ' #captcha-error').show()} else{$('#power_forms_' + formId + ' #captcha-error').removeClass('wppowerformerror'); $('#power_forms_' + formId + ' #captcha-error').text(''); $('#power_forms_' + formId + ' #captcha-error').hide(); $('#power_forms_button_' + formId).val('Loading...'); $('.loadersOut').show(); jQuery.ajax({type:'POST', url:frontend_ajax_object.ajaxurl, data:fd, contentType:!1, processData:!1, success:function(response){var htmlResponse = JSON.parse(response); if (htmlResponse.redirect){$('.loadersOut').hide(); window.location = window.location.href + htmlResponse.redirect} else{$('.loadersOut').hide(); $('#' + htmlResponse.id).prepend(htmlResponse.html); $('#power_forms_button_' + formId).val('Submit'); setTimeout(function(){$('.error_other').remove(); $('.sucess_message').remove()}, 3000)}}, error:function(xhr, ajaxOptions, thrownError){$('.loadersOut').hide(); $('#' + htmlResponse.id).prepend(thrownError); $('#power_forms_button_' + formId).val('Submit'); setTimeout(function(){$('.error_other').remove(); $('.sucess_message').remove()}, 3000)}})}}); jQuery(document).on('submit', '#power_forms_gdpr_code', function(e){e.preventDefault(); var gdpremail = $('#pf_gdpr_email').val(); var gdprCheck = $('#pf_gdpr_checkbox').val(); $('.loadersOut').show(); jQuery.ajax({type:'POST', url:frontend_ajax_object.ajaxurl, data:{action:"pf_save_frontend_gdpr_form", gdpremail:gdpremail, gdprCheck:gdprCheck}, success:function(response){var html = JSON.parse(response).html; $('#power_forms_gdpr_code').prepend(html); $('.loadersOut').hide(); setTimeout(function(){$('.error_other').remove(); $('.sucess_message').remove()}, 3000)}, error:function(xhr, ajaxOptions, thrownError){$('#power_forms_gdpr_code').prepend(thrownError); $('.loadersOut').hide(); setTimeout(function(){$('.error_other').remove(); $('.sucess_message').remove()}, 3000)}})})}); $(document).ready(function(){var table = $('#example').DataTable({buttons:['excel', 'pdf'], }); if (table){table.buttons().container().insertBefore('#example_filter')}}); $(document).on('click', '.deleteRequest', function(e){e.preventDefault(); var pfid = $(this).attr('data-id'); var pfemail = $(this).attr('data-email'); $('.loadersOut').show(); jQuery.ajax({type:'POST', url:frontend_ajax_object.ajaxurl, data:{action:"pf_save_delete_request", pfid:pfid, pfemail:pfemail}, success:function(response){var html = JSON.parse(response).html; $('#example_wrapper').prepend(html); $('.loadersOut').hide(); location.reload()}, error:function(xhr, ajaxOptions, thrownError){$('#example_wrapper').prepend(thrownError); $('.loadersOut').hide(); setTimeout(function(){$('.error_other').remove(); $('.sucess_message').remove()}, 3000)}})})
jQuery(document).on("click", "#viewButton", function () {var formId = jQuery(this).data('id');$('.view-content').html('');jQuery.ajax({type: 'POST',url: frontend_ajax_object.ajaxurl,data: {action: "pf_open_frontend_gdpr_data_detail",formId: formId,},success: function (response) {var htmlResponse = JSON.parse(response);
$('.view-content').html(htmlResponse.html);},error: function (xhr, ajaxOptions, thrownError){alert(thrownError);}});});
})(jQuery)